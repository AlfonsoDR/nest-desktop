#!/bin/bash

pid() {
  pgrep -f 'python3 nest-serve.py'
}

status() {
  export pid=`nest-desktop pid`
  if [ $pid ]; then
    echo 'NEST Desktop is running.'
  else
    echo 'NEST Desktop is not running.'
  fi
}

start() {
  export pid=`nest-desktop pid`
  if [ $pid ]; then
    echo 'NEST Desktop is already running.'
  else
    cd $NESTDESKTOP_PATH/bin/
    python3 nest-serve.py --dir $NESTDESKTOP_PATH/app
  fi
}

stop() {
  export pid=`nest-desktop pid`
  if [ $pid ]; then
    kill $pid
    echo 'NEST Desktop has stopped.'
  fi
}

case "$1" in
  pid) pid ;;
  status)  status ;;
  start)   start ;;
  stop)    stop ;;
  restart) stop; start ;;
  *) echo "usage: $0 pid|status|start|stop|restart" >&2
     exit 1
     ;;
esac
